
%config CONFIG_MUTEK
  desc MutekH kernel core
  default defined
  module mutek Mutek
  flags mandatory root nodefine
%config end

%config CONFIG_MUTEK_META
  desc	meta configuration token used to impose requirements
  default defined
  flags	mandatory noexport nodefine
  require CONFIG_MUTEK_MEMALLOC_SIMPLE CONFIG_MUTEK_MEMALLOC_SMART CONFIG_MUTEK_MEMALLOC_EXPERIMENTAL
  single  CONFIG_MUTEK_MEMALLOC_SIMPLE CONFIG_MUTEK_MEMALLOC_SMART CONFIG_MUTEK_MEMALLOC_EXPERIMENTAL
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MAIN
  desc Enable Mutek global intialization. provide mutek_main() and mutek_main_smp() functions.
  desc Can be disabled if application code handle all the initialization stuff.
  default defined
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_CONSOLE
  desc Enable text console support
  when CONFIG_DRIVER_TTY
  when CONFIG_DRIVER_UART
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_TIMERMS
  desc Provide a general purpose milliseconds timer object
  when CONFIG_DRIVER_TIMER
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_LOGO
  desc Add builtin MutekH logo bitmap to the kernel
  depend CONFIG_DRIVER_FB
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_NUMA
  desc Support of non uniform memory access platform
  depend CONFIG_MUTEK_MEMALLOC_SMART
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_PRINTK
  desc Provide printk() for kernel messages
  default defined
  parent CONFIG_MUTEK
%config end

%config CONFIG_PRINTF_ARG_SIMPLE
  desc libc printf() features are reduced
  default undefined
  parent CONFIG_MUTEK
%config end

%config CONFIG_PRINTF_ARG_EXT
  desc libc printf support %S and %P extentions to dump buffers
  default defined
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_SMP_APP_START
  desc let all processors enter app_start function
  default undefined
  parent CONFIG_MUTEK
%config end

######################################################################
#		Vmem

%config CONFIG_VMEM
  desc Provide virtual memory support
  depend CONFIG_HEXO_MMU
  depend CONFIG_VMEM_PHYS_ALLOC
  depend CONFIG_VMEM_KERNEL_ALLOC
  exclude CONFIG_MUTEK_MEMALLOC_SIMPLE
  parent CONFIG_MUTEK
%config end

%config CONFIG_VMEM_PHYS_ALLOC
  desc Provide physical page allocator for virtual memory
  parent CONFIG_VMEM
  default defined
%config end

%config CONFIG_VMEM_KERNEL_ALLOC
  desc Provide kernel virtual address space allocator
  default defined
  parent CONFIG_VMEM
  require CONFIG_HEXO_MMU
  require CONFIG_VMEM_PHYS_ALLOC
%config end

######################################################################
#		Scheduler

%config CONFIG_MUTEK_SCHEDULER
  desc Hexo scheduler feature is enabled
  default defined
  require CONFIG_MUTEK_SCHEDULER_IDLE_STACK_SIZE
  require CONFIG_MUTEK_SCHEDULER_MIGRATION CONFIG_MUTEK_SCHEDULER_STATIC
  single  CONFIG_MUTEK_SCHEDULER_MIGRATION CONFIG_MUTEK_SCHEDULER_STATIC
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_SCHEDULER_PREEMPT
  desc Scheduler is preemptiv
  parent CONFIG_MUTEK_SCHEDULER
  depend CONFIG_DRIVER_TIMER
  parent CONFIG_MUTEK_SCHEDULER
%config end

%config CONFIG_MUTEK_SCHEDULER_MIGRATION
  desc Scheduler algorithm use permanent context migration among available processors
  when CONFIG_MUTEK_SCHEDULER_STATIC!
  parent CONFIG_MUTEK_SCHEDULER
  default undefined
%config end

%config CONFIG_MUTEK_SCHEDULER_STATIC
  desc Scheduler algorithm use per cpu context list
  parent CONFIG_MUTEK_SCHEDULER
  default undefined
%config end

%config CONFIG_MUTEK_SCHEDULER_MIGRATION_AFFINITY
  desc Handle scheduler context cpu affininty in migration mode
  depend CONFIG_MUTEK_SCHEDULER_MIGRATION
  depend CONFIG_SMP
  parent CONFIG_MUTEK_SCHEDULER
  default undefined
%config end

%config CONFIG_MUTEK_SCHEDULER_IDLE_STACK_SIZE
  desc Size of the stack allocated for idle scheduler context.
  desc Stack size is specified in stack bytes count.
  flags value
  parent CONFIG_MUTEK_SCHEDULER
  default 2048
%config end

%config CONFIG_MUTEK_SCHEDULER_CANDIDATE_FCN
  desc Enables sched_context_candidate_fcn(), uses an external function to check if a running thread must be selected
  parent CONFIG_MUTEK_SCHEDULER
%config end

%config CONFIG_MUTEK_RWLOCK
  depend CONFIG_MUTEK_SCHEDULER
  default defined
  desc Provide read/write locks based on hexo scheduler
%config end

######################################################################
#		Memory allocator

%config CONFIG_MUTEK_MEM_REGION
  desc Enable use of memory region handler.
  default undefined
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_SIMPLE
  desc Enable use of simple memory allocation algorithm.
  desc Incremental memory allocation without freeing.
  default undefined
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_EXPERIMENTAL
  desc Enable use of experimental memory allocation algorithm.
  default undefined
  require CONFIG_MUTEK_MEMALLOC_ALGO_FIRSTFIT CONFIG_MUTEK_MEMALLOC_ALGO_BESTFIT
  single CONFIG_MUTEK_MEMALLOC_ALGO_FIRSTFIT CONFIG_MUTEK_MEMALLOC_ALGO_BESTFIT
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_SMART
  desc Enable use of memory allocation algorithm.
  when CONFIG_MUTEK_MEMALLOC_EXPERIMENTAL! CONFIG_MUTEK_MEMALLOC_SIMPLE!
  default undefined
  require CONFIG_MUTEK_MEMALLOC_ALGO_FIRSTFIT CONFIG_MUTEK_MEMALLOC_ALGO_BESTFIT
  single CONFIG_MUTEK_MEMALLOC_ALGO_FIRSTFIT CONFIG_MUTEK_MEMALLOC_ALGO_BESTFIT
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_ALGO_FIRSTFIT
  desc select memory allocation algorithm first fit
  parent CONFIG_MUTEK_MEMALLOC_SMART CONFIG_MUTEK_MEMALLOC_EXPERIMENTAL
  default defined
%config end

%config CONFIG_MUTEK_MEMALLOC_ALGO_BESTFIT
  desc select memory allocation algorithm best fit
  parent CONFIG_MUTEK_MEMALLOC_SMART CONFIG_MUTEK_MEMALLOC_EXPERIMENTAL
  default undefined
%config end

%config CONFIG_MUTEK_MEMALLOC_ALIGN
  desc Memory allocation block address alignment
  default 0x20
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_DEBUG
  desc When enabled all allocated and freed memory blocks will filled be with 0x5a and 0xa5 bytes
  when CONFIG_DEBUG
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_STATS
  desc keep stats about allocated blocks count and size
  depend CONFIG_MUTEK_MEMALLOC_SMART
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_CRC
  desc When enabled all memory block headers will include a CRC32
  depend CONFIG_MUTEK_MEMALLOC_SMART
  when CONFIG_DEBUG
  depend CONFIG_LIBCRYPTO_CRC32
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_GUARD
  desc Add a guard zone before and after each allocated block.
  desc All guard zone content can be check with the mem_guard_check() function to detect bad memory write access.
  depend CONFIG_MUTEK_MEMALLOC_SMART
  depend CONFIG_MUTEK_MEMALLOC_DEBUG
  suggest CONFIG_MUTEK_MEMALLOC_ALIGN=1
  require CONFIG_MUTEK_MEMALLOC_GUARD_SIZE
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_GUARD_SIZE
  desc Memory allocation debug guard zone size in bytes.
  parent CONFIG_MUTEK_MEMALLOC_GUARD
  default 256
  parent CONFIG_MUTEK
%config end

%config CONFIG_MUTEK_MEMALLOC_GUARD_INSTRUMENT
  desc Automatically check guard zone on all function calls and returns.
  parent CONFIG_MUTEK_MEMALLOC_GUARD
  depend CONFIG_COMPILE_INSTRUMENT
  parent CONFIG_MUTEK
%config end

