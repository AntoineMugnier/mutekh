/*
    This file is part of MutekH.

    MutekH is free software; you can redistribute it and/or modify it
    under the terms of the GNU Lesser General Public License as
    published by the Free Software Foundation; version 2.1 of the
    License.

    MutekH is distributed in the hope that it will be useful, but
    WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
    Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public
    License along with this program.  If not, see
    <http://www.gnu.org/licenses/>.

    Copyright (c) Nicolas Pouillon <nipo@ssji.net>, 2016
*/

#ifndef PSOC4_VARIANT_PSOC_H
#define PSOC4_VARIANT_PSOC_H

#include <arch/psoc4/variant/common.h>

/*
  Peripheral addresses
 */

#define PSOC4_SFLASH_ADDR       0x10000000
#define PSOC4_CPUSS_ADDR        0x40000000
#define PSOC4_HSIOM_PRT_ADDR(x) (PSOC4_HSIOM_PRT0_ADDR + ((x) << 8))
#define PSOC4_HSIOM_PRT0_ADDR   0x40010000
#define PSOC4_HSIOM_PRT1_ADDR   0x40010100
#define PSOC4_HSIOM_PRT2_ADDR   0x40010200
#define PSOC4_HSIOM_PRT3_ADDR   0x40010300
#define PSOC4_HSIOM_PRT4_ADDR   0x40010400
#define PSOC4_HSIOM_PRT5_ADDR   0x40010500
#define PSOC4_PCLK_ADDR         0x40020000
#define PSOC4_GPIO_PRT_ADDR(x)  (PSOC4_GPIO_PRT0_ADDR + ((x) << 8))
#define PSOC4_GPIO_PRT0_ADDR    0x40040000
#define PSOC4_GPIO_PRT1_ADDR    0x40040100
#define PSOC4_GPIO_PRT2_ADDR    0x40040200
#define PSOC4_GPIO_PRT3_ADDR    0x40040300
#define PSOC4_GPIO_PRT4_ADDR    0x40040400
#define PSOC4_GPIO_PRT5_ADDR    0x40040500
#define PSOC4_TCPWM_ADDR        0x40050000
#define PSOC4_SCB_ADDR          0x40060000
#define PSOC4_CSD_ADDR          0x40080000
#define PSOC4_LCD_ADDR          0x40090000
#define PSOC4_LPCOMP_ADDR       0x400A0000
#define PSOC4_SRSS_ADDR         0x400B0000
#define PSOC4_UDB_ADDR          0x400F0000

#define PSOC4_GPIO_PORT_COUNT 5

/*
  IRQs
 */

#define PSOC4_IRQ_GPIO(x)  (0 + (x))
#define PSOC4_IRQ_GPIO0    0
#define PSOC4_IRQ_GPIO1    1
#define PSOC4_IRQ_GPIO2    2
#define PSOC4_IRQ_GPIO3    3
#define PSOC4_IRQ_GPIO4    4
#define PSOC4_IRQ_LPCOMP   8
#define PSOC4_IRQ_WDT      9
#define PSOC4_IRQ_SCB(x)   (10 + (x))
#define PSOC4_IRQ_SCB0     10
#define PSOC4_IRQ_SCB1     11
#define PSOC4_IRQ_SPCIF    12
#define PSOC4_IRQ_PWR      13
#define PSOC4_IRQ_SAR      14
#define PSOC4_IRQ_CSD      15
#define PSOC4_IRQ_TCPWM(x) (16 + (x))
#define PSOC4_IRQ_TCPWM0   16
#define PSOC4_IRQ_TCPWM1   17
#define PSOC4_IRQ_TCPWM2   18
#define PSOC4_IRQ_TCPWM3   19
#define PSOC4_IRQ_DSI(x)   (20 + (x))

/*
  Clocks
 */

enum psoc4_clock_e {
  // Source endpoints
  PSOC4_CLOCK_SRC_PER_0,
  PSOC4_CLOCK_SRC_PER_1,
  PSOC4_CLOCK_SRC_PER_2,
  PSOC4_CLOCK_SRC_PER_3,
  PSOC4_CLOCK_SRC_PER_4,
  PSOC4_CLOCK_SRC_PER_5,
  PSOC4_CLOCK_SRC_PER_6,
  PSOC4_CLOCK_SRC_PER_7,
  PSOC4_CLOCK_SRC_PER_8,
  PSOC4_CLOCK_SRC_PER_9,
  PSOC4_CLOCK_SRC_PER_10,
  PSOC4_CLOCK_SRC_PER_11,
  PSOC4_CLOCK_SRC_PER_12,
  PSOC4_CLOCK_SRC_PER_13,
  PSOC4_CLOCK_SRC_PER_14,
  PSOC4_CLOCK_SRC_PER_15,
#define PSOC4_CLOCK_PCLK_COUNT 16
  // Also configurable as scaler
  PSOC4_CLOCK_SRC_SYSCLK,
  // Also configurable as mux between IMO and EXTCLK
  PSOC4_CLOCK_SRC_HFCLK,
  // Mask of all HFCLK-based sources
#define PSOC4_CLOCK_SRC_HF_MASK ((1 << (PSOC4_CLOCK_SRC_HFCLK + 1)) - 1)
#define PSOC4_CLOCK_SRC_NOSLEEP_MASK (PSOC4_CLOCK_SRC_HF_MASK & ~(1 << PSOC4_CLOCK_SRC_SYSCLK))
  PSOC4_CLOCK_SRC_LFCLK,
#define PSOC4_CLOCK_SRC_COUNT (PSOC4_CLOCK_SRC_LFCLK + 1)
  // Oscillators
  // Configurable frequency and accuracy
  PSOC4_CLOCK_OSC_IMO,
#if defined(CONFIG_DRIVER_PSOC4_CLOCK_EXTCLK)
  PSOC4_CLOCK_OSC_EXTCLK,
#endif
  PSOC4_CLOCK_OSC_ILO,

  PSOC4_CLOCK_NODE_COUNT,
};

#define PSOC4_CLOCK_IMO_SS PSOC4_CLOCK_SRC_PER_0
#define PSOC4_CLOCK_PUMP   PSOC4_CLOCK_SRC_PER_1
#define PSOC4_CLOCK_SCB0   PSOC4_CLOCK_SRC_PER_2
#define PSOC4_CLOCK_SCB1   PSOC4_CLOCK_SRC_PER_3
#define PSOC4_CLOCK_LCD    PSOC4_CLOCK_SRC_PER_4
#define PSOC4_CLOCK_CSD0   PSOC4_CLOCK_SRC_PER_5
#define PSOC4_CLOCK_CSD1   PSOC4_CLOCK_SRC_PER_6
#define PSOC4_CLOCK_SAR    PSOC4_CLOCK_SRC_PER_7
#define PSOC4_CLOCK_TCPWM0 PSOC4_CLOCK_SRC_PER_8
#define PSOC4_CLOCK_TCPWM1 PSOC4_CLOCK_SRC_PER_9
#define PSOC4_CLOCK_TCPWM2 PSOC4_CLOCK_SRC_PER_10
#define PSOC4_CLOCK_TCPWM3 PSOC4_CLOCK_SRC_PER_11
#define PSOC4_CLOCK_UDB0   PSOC4_CLOCK_SRC_PER_12
#define PSOC4_CLOCK_UDB1   PSOC4_CLOCK_SRC_PER_13
#define PSOC4_CLOCK_UDB2   PSOC4_CLOCK_SRC_PER_14
#define PSOC4_CLOCK_UDB3   PSOC4_CLOCK_SRC_PER_15

/*
  Pin mux
 */

#define PSOC4_P0_0 PSOC4_IO(0, 0)
#define PSOC4_P0_1 PSOC4_IO(0, 1)
#define PSOC4_P0_2 PSOC4_IO(0, 2)
#define PSOC4_P0_3 PSOC4_IO(0, 3)
#define PSOC4_P0_4 PSOC4_IO(0, 4)
#define PSOC4_P0_5 PSOC4_IO(0, 5)
#define PSOC4_P0_6 PSOC4_IO(0, 6)
#define PSOC4_P0_7 PSOC4_IO(0, 7)
#define PSOC4_P1_0 PSOC4_IO(1, 0)
#define PSOC4_P1_1 PSOC4_IO(1, 1)
#define PSOC4_P1_2 PSOC4_IO(1, 2)
#define PSOC4_P1_3 PSOC4_IO(1, 3)
#define PSOC4_P1_4 PSOC4_IO(1, 4)
#define PSOC4_P1_5 PSOC4_IO(1, 5)
#define PSOC4_P1_6 PSOC4_IO(1, 6)
#define PSOC4_P1_7 PSOC4_IO(1, 7)
#define PSOC4_P2_0 PSOC4_IO(2, 0)
#define PSOC4_P2_1 PSOC4_IO(2, 1)
#define PSOC4_P2_2 PSOC4_IO(2, 2)
#define PSOC4_P2_3 PSOC4_IO(2, 3)
#define PSOC4_P2_4 PSOC4_IO(2, 4)
#define PSOC4_P2_5 PSOC4_IO(2, 5)
#define PSOC4_P2_6 PSOC4_IO(2, 6)
#define PSOC4_P2_7 PSOC4_IO(2, 7)
#define PSOC4_P3_0 PSOC4_IO(3, 0)
#define PSOC4_P3_1 PSOC4_IO(3, 1)
#define PSOC4_P3_2 PSOC4_IO(3, 2)
#define PSOC4_P3_3 PSOC4_IO(3, 3)
#define PSOC4_P3_4 PSOC4_IO(3, 4)
#define PSOC4_P3_5 PSOC4_IO(3, 5)
#define PSOC4_P3_6 PSOC4_IO(3, 6)
#define PSOC4_P3_7 PSOC4_IO(3, 7)
#define PSOC4_P4_0 PSOC4_IO(4, 0)
#define PSOC4_P4_1 PSOC4_IO(4, 1)
#define PSOC4_P4_2 PSOC4_IO(4, 2)
#define PSOC4_P4_3 PSOC4_IO(4, 3)

#define PSOC4_P0_0_COMP1_INP         //ANALOG
#define PSOC4_P0_0_SCB0_SPI_SSEL_1   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P0_1_COMP1_INN         //ANALOG
#define PSOC4_P0_1_SCB0_SPI_SSEL_2   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P0_2_COMP2_INP         //ANALOG
#define PSOC4_P0_2_SCB0_SPI_SSEL_3   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P0_3_COMP2_INN         //ANALOG
#define PSOC4_P0_4_SCB1_UART_RX_1    HSIOM_PORT_SEL_IO_SEL_ACT_1
#define PSOC4_P0_4_SCB1_I2C_SCL_1    HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P0_4_SCB1_SPI_MOSI_1   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P0_5_SCB1_UART_TX_1    HSIOM_PORT_SEL_IO_SEL_ACT_1
#define PSOC4_P0_5_SCB1_I2C_SDA_1    HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P0_5_SCB1_SPI_MISO_1   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P0_6_EXT_CLK           HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P0_6_SCB1_SPI_CLK_1    HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P0_7_WAKEUP            HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P0_7_SCB1_SPI_SSEL_0_1 HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P1_0_CTB_OA0_INP       //ANALOG
#define PSOC4_P1_0_TCPWM2_P_1        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P1_1_CTB_OA0_INM       //ANALOG
#define PSOC4_P1_1_TCPWM2_N_1        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P1_2_CTB_OA0_OUT       //ANALOG
#define PSOC4_P1_2_TCPWM3_P_1        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P1_3_CTB_OA1_OUT       //ANALOG
#define PSOC4_P1_3_TCPWM3_N_1        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P1_4_CTB_OA1_INM       //ANALOG
#define PSOC4_P1_5_CTB_OA1_INP       //ANALOG
#define PSOC4_P1_6_CTB_OA0_INP_ALT   //ANALOG
#define PSOC4_P1_7_CTB_OA1_INP_ALT   //ANALOG
#define PSOC4_P2_0_SARMUX_0          //ANALOG
#define PSOC4_P2_1_SARMUX_1          //ANALOG
#define PSOC4_P2_2_SARMUX_2          //ANALOG
#define PSOC4_P2_3_SARMUX_3          //ANALOG
#define PSOC4_P2_4_SARMUX_4          //ANALOG
#define PSOC4_P2_4_TCPWM0_P_1        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P2_5_SARMUX_5          //ANALOG
#define PSOC4_P2_5_TCPWM0_N_1        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P2_6_SARMUX_6          //ANALOG
#define PSOC4_P2_6_TCPWM1_P_1        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P2_7_SARMUX_7          //ANALOG
#define PSOC4_P2_7_TCPWM1_N_1        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P3_0_TCPWM0_P_0        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P3_0_SCB1_UART_RX_0    HSIOM_PORT_SEL_IO_SEL_ACT_1
#define PSOC4_P3_0_SCB1_I2C_SCL_0    HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P3_0_SCB1_SPI_MOSI_0   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P3_1_TCPWM0_N_0        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P3_1_SCB1_UART_TX_0    HSIOM_PORT_SEL_IO_SEL_ACT_1
#define PSOC4_P3_1_SCB1_I2C_SDA_0    HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P3_1_SCB1_SPI_MISO_0   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P3_2_TCPWM1_P_0        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P3_2_SWD_IO_0          HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P3_2_SCB1_SPI_CLK_0    HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P3_3_TCPWM1_N_0        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P3_3_SWD_CLK_0         HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P3_3_SCB1_SPI_SSEL_0_0 HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P3_4_TCPWM2_P_0        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P3_4_SCB1_SPI_SSEL_1   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P3_5_TCPWM2_N_0        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P3_5_SCB1_SPI_SSEL_2   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P3_6_TCPWM3_P_0        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P3_6_SWD_IO_1          HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P3_6_SCB1_SPI_SSEL_3   HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P3_7_TCPWM3_N_0        HSIOM_PORT_SEL_IO_SEL_ACT_0
#define PSOC4_P3_7_SWD_CLK_1         HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P4_0_SCB0_UART_RX      HSIOM_PORT_SEL_IO_SEL_ACT_1
#define PSOC4_P4_0_SCB0_I2C_SCL      HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P4_0_SCB0_SPI_MOSI     HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P4_1_SCB0_UART_TX      HSIOM_PORT_SEL_IO_SEL_ACT_1
#define PSOC4_P4_1_SCB0_I2C_SDA      HSIOM_PORT_SEL_IO_SEL_ACT_2
#define PSOC4_P4_1_SCB0_SPI_MISO     HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P4_2_CSD_C_MOD         //ANALOG
#define PSOC4_P4_2_SCB0_SPI_CLK      HSIOM_PORT_SEL_IO_SEL_ACT_3
#define PSOC4_P4_3_CSD_C_SH_TANK     //ANALOG
#define PSOC4_P4_3_SCB0_SPI_SSEL_0   HSIOM_PORT_SEL_IO_SEL_ACT_3

#endif
