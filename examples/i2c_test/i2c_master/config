%set OUTPUT_NAME i2c_master

# New source code module to be compiled
%append MODULES $(OUTPUT_NAME):$(CONFIGPATH)

# Application license
CONFIG_LICENSE_APP_LGPL

# Libs
CONFIG_PTHREAD
CONFIG_PTHREAD_MAIN
CONFIG_MUTEK_SEMAPHORE

CONFIG_DEVICE_I2C_BYTECODE
CONFIG_DEVICE_I2C_BYTECODE_TIMER
CONFIG_DEVICE_I2C_TRANSACTION

CONFIG_MUTEK_BYTECODE_VM
CONFIG_MUTEK_BYTECODE_NATIVE
CONFIG_MUTEK_BYTECODE_CHECKING
CONFIG_MUTEK_BYTECODE_DEBUG
CONFIG_MUTEK_BYTECODE_TRACE

%section nrf5x-pca10028
  CONFIG_I2C_TEST_BOARD_NAME pca10028
  CONFIG_DRIVER_NRF5X_I2C
%end

%section nrf5x-pca10040
  CONFIG_I2C_TEST_BOARD_NAME pca10040

  %section twim
    CONFIG_DRIVER_NRF52_TWIM
  %else
    CONFIG_DRIVER_NRF5X_I2C
  %end
%end

%section nrf5x-*
  CONFIG_DRIVER_NRF5X_CLOCK
  CONFIG_DRIVER_NRF5X_TIMER
  CONFIG_DRIVER_NRF5X_GPIO

  %subsection printk-uart
    CONFIG_DRIVER_NRF5X_PRINTK
  %end

  %subsection shell-rtt
    CONFIG_DRIVER_CHAR_RTT
    CONFIG_DRIVER_CHAR_RTT_RX_BUFFER_SIZE 128
    %inherit shell
  %end
%end

%include scripts/options.build
%include arch/arch.build

#CONFIG_COMPILE_OPTIMIZE s
CONFIG_COMPILE_DEBUG
CONFIG_HEXO_IRQ defined

CONFIG_PTHREAD_STACK_SIZE 0x1000

CONFIG_DEVICE_SPI undefined

CONFIG_HEXO_STACK_ALIGN 32
CONFIG_CPU_ARM32M_MPU_STACK_GUARD defined
